# Application
PROJECT_NAME=LMS Backend
VERSION=1.0.0
ENVIRONMENT=production
API_V1_PREFIX=/api/v1
DEBUG=false
ENABLE_API_DOCS=false
STRICT_ROUTER_IMPORTS=true
METRICS_ENABLED=true
METRICS_PATH=/metrics
API_RESPONSE_ENVELOPE_ENABLED=true
API_RESPONSE_SUCCESS_MESSAGE=Success
API_RESPONSE_ENVELOPE_EXCLUDED_PATHS=/docs,/redoc,/openapi.json,/metrics,/api/v1/health,/api/v1/ready,/api/v1/auth/token
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.0
SENTRY_SEND_PII=false
SENTRY_ENABLE_FOR_CELERY=true
WEBHOOKS_ENABLED=false
WEBHOOK_TARGET_URLS=
WEBHOOK_SIGNING_SECRET=
WEBHOOK_TIMEOUT_SECONDS=5.0

# Azure Key Vault Configuration (Required for production security)
# For Managed Identity authentication (recommended for Azure deployments)
AZURE_KEYVAULT_URL=https://your-lms-keyvault.vault.azure.net
# AZURE_CLIENT_ID=your-managed-identity-client-id  # Optional for specific identity

# For Service Principal authentication (alternative)
# AZURE_TENANT_ID=your-tenant-id
# AZURE_CLIENT_ID=your-service-principal-client-id
# AZURE_CLIENT_SECRET=your-service-principal-secret

# Database (values will be overridden by Azure Key Vault in production)
POSTGRES_USER=lmsadmin
POSTGRES_PASSWORD=placeholder-for-azure-key-vault
POSTGRES_DB=lms
DATABASE_URL=postgresql+psycopg2://lmsadmin:placeholder-for-azure-key-vault@your-server.postgres.database.azure.com:5432/lms?sslmode=require
PROD_DATABASE_URL=postgresql+psycopg2://lmsadmin:placeholder-for-azure-key-vault@your-server.postgres.database.azure.com:5432/lms?sslmode=require
DB_WAIT_TIMEOUT_SECONDS=180
DB_WAIT_INTERVAL_SECONDS=2
SQLALCHEMY_ECHO=false
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40

# Security (values will be overridden by Azure Key Vault)
SECRET_KEY=placeholder-for-azure-key-vault
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=15
REFRESH_TOKEN_EXPIRE_DAYS=30
PASSWORD_RESET_TOKEN_EXPIRE_MINUTES=30
EMAIL_VERIFICATION_TOKEN_EXPIRE_MINUTES=1440
ALLOW_PUBLIC_ROLE_REGISTRATION=false
REQUIRE_EMAIL_VERIFICATION_FOR_LOGIN=true
MFA_CHALLENGE_TOKEN_EXPIRE_MINUTES=10
MFA_LOGIN_CODE_EXPIRE_MINUTES=10
MFA_LOGIN_CODE_LENGTH=6
ACCESS_TOKEN_BLACKLIST_ENABLED=true
ACCESS_TOKEN_BLACKLIST_FAIL_CLOSED=true
ACCESS_TOKEN_BLACKLIST_PREFIX=auth:blacklist:access
SECURITY_HEADERS_ENABLED=true
FRONTEND_BASE_URL=https://egylms.duckdns.org
EMAIL_FROM=<verified-sender@your-domain>
SMTP_HOST=smtp.resend.com
SMTP_PORT=587
SMTP_USERNAME=resend
SMTP_PASSWORD=placeholder-for-azure-key-vault
SMTP_USE_TLS=true
SMTP_USE_SSL=false

# Optional Firebase
# Set FIREBASE_FUNCTIONS_URL to use Firebase Cloud Functions as email transport.
# When using Firebase transport, SMTP_* can stay as fallback only.
FIREBASE_ENABLED=false
FIREBASE_PROJECT_ID=
FIREBASE_PRIVATE_KEY=
FIREBASE_CLIENT_EMAIL=
FIREBASE_AUTH_EMULATOR_HOST=
FIREBASE_FUNCTIONS_URL=
FIREBASE_FUNCTIONS_API_KEY=

# Domain / TLS (Caddy)
APP_DOMAIN=egylms.duckdns.org
LETSENCRYPT_EMAIL=ops@example.com

# CORS / Hosts
CORS_ORIGINS=https://egylms.duckdns.org
TRUSTED_HOSTS=egylms.duckdns.org

# Redis / Celery
REDIS_URL=redis://redis:6379/0
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2
PROD_REDIS_URL=redis://redis:6379/0
PROD_CELERY_BROKER_URL=redis://redis:6379/1
PROD_CELERY_RESULT_BACKEND=redis://redis:6379/2
TASKS_FORCE_INLINE=false
RATE_LIMIT_USE_REDIS=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_WINDOW_SECONDS=60
RATE_LIMIT_REDIS_PREFIX=ratelimit
RATE_LIMIT_EXCLUDED_PATHS=/,/docs,/redoc,/openapi.json,/api/v1/health,/api/v1/ready,/metrics
AUTH_RATE_LIMIT_REQUESTS_PER_MINUTE=5
AUTH_RATE_LIMIT_WINDOW_SECONDS=60
AUTH_RATE_LIMIT_PATHS=/api/v1/auth/login,/api/v1/auth/token,/api/v1/auth/login/mfa
MAX_FAILED_LOGIN_ATTEMPTS=5
FILE_UPLOAD_RATE_LIMIT_REQUESTS_PER_HOUR=10
FILE_UPLOAD_RATE_LIMIT_WINDOW_SECONDS=3600
FILE_UPLOAD_RATE_LIMIT_PATHS=/api/v1/files/upload

# Cache
CACHE_ENABLED=true
CACHE_KEY_PREFIX=app:cache
CACHE_DEFAULT_TTL_SECONDS=120
COURSE_CACHE_TTL_SECONDS=120
LESSON_CACHE_TTL_SECONDS=120
QUIZ_CACHE_TTL_SECONDS=120
QUIZ_QUESTION_CACHE_TTL_SECONDS=120

# File Uploads
UPLOAD_DIR=uploads
CERTIFICATES_DIR=certificates
MAX_UPLOAD_MB=100
ALLOWED_UPLOAD_EXTENSIONS=mp4,avi,mov,pdf,doc,docx,jpg,jpeg,png
FILE_STORAGE_PROVIDER=local
FILE_DOWNLOAD_URL_EXPIRE_SECONDS=900

# Optional Azure Blob Storage (values will be overridden by Azure Key Vault)
AZURE_STORAGE_CONNECTION_STRING=placeholder-for-azure-key-vault
AZURE_STORAGE_ACCOUNT_NAME=placeholder-for-azure-key-vault
AZURE_STORAGE_ACCOUNT_KEY=placeholder-for-azure-key-vault
AZURE_STORAGE_ACCOUNT_URL=
AZURE_STORAGE_CONTAINER_NAME=
AZURE_STORAGE_CONTAINER_URL=
